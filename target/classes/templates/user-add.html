<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Login Page</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" th:href="@{/images/style.css}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <title>Manage User | Display or Add</title>

    <style>
        .container{
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 300px;
            margin-left: 30%;
            border: 2px solid green;
            border-radius: 8px;
            background-color: #447D9B;
            color: #FBF5DE;

        }
        .form{
            margin-bottom: 4px;
            padding: 4px 8px 8px 8px;
        }
        input{
            padding: 4px;
            margin: 4px;
            border: 1px solid green;
            border-radius: 4px;
        }
        select{
            padding: 4px;
            margin: 4px;
            border: 1px solid black;
            border-radius: 4px;
            background-color: #447D9B;
            color: #FBF5DE;
        }

        .button{
            color: white;
            background-color: blue;
            border: 2px solid white;
            border-radius: 8px;
            padding: 8px;
            width: 100%;
        }
        .button:hover{
            background-color: white;
            color: blue;
            border: 2px solid blue;
            transition-duration: .4s;

        }

        a{
            text-decoration: none;
            color: white;
        }
        .error{
            color:red;
        }
    </style>
</head>

<body>
    <div class="back">
        <a th:href="@{/details/}"><img th:src="@{/images/back.png}"></a>
    </div>

    <div th:if="${param.success}">
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <strong style="margin-right: 4px">Success! </strong>User is Added.
            <button style="float:right;" type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">X</button>
        </div>
    </div>

    <div th:if="${param.danger}">
        <div class="alert alert-danger" role="alert">
            <strong style="margin-right: 4px">Success! </strong>User is Deleted.
            <button style="float:right;" type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">X</button>
        </div>
    </div>

    <div class="table">
        <table class="table table-bordered">
            <thead>
            <tr>
                <th>Name</th><th>Role</th><th>Action</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="tempData : ${userList}">
                <td th:text="${tempData.username}"></td>
                <td th:text="${tempData.userAuthority}"></td>
                <td>
                    <a th:href="@{/users/delete(userId=${tempData.id})}" id="delete" onclick="if (!(confirm('Are you sure you want to delete the user?'))) return false">Delete</a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
    <div class="container">
        <div>
            <h2>Add User</h2>
        </div>

        <!-- Login Form -->
        <div class="form">
            <form action="#" th:action="@{/users}" th:object="${user}" method="post" class="form-horizontal">

                <table>
                    <tr>
                        <td>Username</td>
                        <td>
                            <input placeholder="username" th:field="*{username}"><span th:if="${#fields.hasErrors('username')}"
                                                                                       th:errors="*{username}"
                                                                                       class="error"></span>
                        </td>
                    </tr>

                    <tr>
                        <td>Password</td>
                        <td>
                            <input type="password" placeholder="password" th:field="*{password}"><span th:if="${#fields.hasErrors('password')}"
                                                                                       th:errors="*{password}"
                                                                                       class="error"></span>
                        </td>
                    </tr>

                    <tr>
                        <td>Authority</td>
                        <td>
                            <select th:field="*{userAuthority}">
                                <option th:value="ROLE_MANAGER">Manager</option>
                                <option th:value="ROLE_ADMIN">Admin</option>
                            </select>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <input type="submit" value="Save" class="button">
                        </td>
                    </tr>
                </table>

            </form>
        </div>
    </div>

</body>
</html>
